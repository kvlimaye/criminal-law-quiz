<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criminal Laws Quiz 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
        }

        .app-container {
            width: 100%;
            max-width: 480px;
            height: 100vh;
            background: #f8f9fa;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        .app-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .app-header h1 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .app-header p {
            font-size: 13px;
            opacity: 0.9;
        }

        .timer-bar {
            background: white;
            padding: 16px 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .timer {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }

        .timer.warning {
            color: #ff9800;
        }

        .timer.critical {
            color: #f44336;
            animation: pulse 1s infinite;
        }

        .question-counter {
            font-size: 14px;
            font-weight: 600;
            color: #666;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 14px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            background: white;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .question-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: auto;
        }

        .question-text {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .option {
            background: #f8f9fa;
            padding: 14px;
            margin-bottom: 10px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .option:hover {
            background: #e8eaf6;
            border-color: #667eea;
        }

        .option.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .option input[type="radio"] {
            display: none;
        }

        .option-label {
            font-size: 15px;
            cursor: pointer;
            display: block;
            padding-left: 32px;
            position: relative;
            line-height: 1.4;
        }

        .option-label::before {
            content: '';
            position: absolute;
            left: 0;
            top: 2px;
            width: 20px;
            height: 20px;
            border: 2px solid #667eea;
            border-radius: 50%;
            background: white;
        }

        .option.selected .option-label::before {
            background: white;
            border-color: white;
        }

        .option.selected .option-label::after {
            content: '‚úì';
            position: absolute;
            left: 5px;
            top: 2px;
            color: #667eea;
            font-size: 13px;
            font-weight: bold;
        }

        .bottom-nav {
            background: white;
            padding: 12px 20px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.08);
            display: flex;
            gap: 12px;
            flex-shrink: 0;
        }

        .btn {
            flex: 1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px;
            font-size: 15px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #666;
            box-shadow: none;
        }

        .result-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 40px 20px;
        }

        .result-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: bounceIn 0.6s ease;
        }

        @keyframes bounceIn {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .result-title {
            font-size: 28px;
            font-weight: bold;
            color: #333;
            margin-bottom: 16px;
        }

        .result-score {
            font-size: 48px;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
        }

        .result-message {
            font-size: 16px;
            color: #666;
            line-height: 1.6;
            margin-bottom: 24px;
            padding: 0 20px;
        }

        .prize-badge {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #333;
            padding: 16px 32px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            box-shadow: 0 4px 16px rgba(255, 215, 0, 0.4);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .progress-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            padding: 12px 20px;
            background: white;
            box-shadow: 0 -1px 4px rgba(0, 0, 0, 0.05);
            flex-shrink: 0;
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #e0e0e0;
            transition: all 0.3s ease;
        }

        .dot.active {
            background: #667eea;
            width: 24px;
            border-radius: 4px;
        }

        .dot.answered {
            background: #4caf50;
        }

        .hidden {
            display: none !important;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 24px;
            border-radius: 16px;
            width: 85%;
            max-width: 340px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 10000;
        }

        .modal-content h2 {
            color: #333;
            margin-bottom: 12px;
            font-size: 20px;
        }

        .modal-content p {
            margin-bottom: 20px;
            font-size: 14px;
            color: #666;
            line-height: 1.6;
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
        }

        .modal-buttons .btn {
            flex: 1;
            padding: 12px;
            font-size: 14px;
        }

        .loading-overlay {
            display: none;
            position: fixed;
            z-index: 10001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            font-size: 18px;
            margin-top: 20px;
            font-weight: 600;
        }

        @media (min-width: 481px) {
            .app-container {
                border-radius: 20px;
                height: auto;
                min-height: 80vh;
                margin: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="app-header">
            <h1>üèõÔ∏è Criminal Laws Quiz 2025</h1>
            <p>BNS, BNSS & BSA</p>
        </div>

        <!-- User Info Screen -->
        <div id="userInfoScreen">
            <div class="content">
                <div class="question-card">
                    <h2 style="color: #667eea; margin-bottom: 20px; font-size: 22px;">Welcome!</h2>
                    
                    <div class="form-group">
                        <label>Your Name</label>
                        <input type="text" id="userName" placeholder="Enter your full name" required>
                    </div>

                    <div class="form-group">
                        <label>Occupation</label>
                        <select id="userOccupation" required>
                            <option value="">Select your occupation</option>
                            <option value="Student">Student</option>
                            <option value="Professional">Professional</option>
                            <option value="Service">Service</option>
                            <option value="Business">Business</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="bottom-nav">
                <button class="btn" onclick="startQuiz()">Start Quiz</button>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quizScreen" class="hidden">
            <div class="timer-bar">
                <div class="timer" id="timer">3:00</div>
            </div>

            <div class="content">
                <div class="question-card">
                    <div style="text-align: center; margin-bottom: 16px;">
                        <span class="question-counter" id="questionCounter">1/10</span>
                    </div>
                    <div class="question-text" id="questionText"></div>
                    <div id="optionsContainer"></div>
                </div>
            </div>

            <div class="progress-dots" id="progressDots"></div>

            <div class="bottom-nav">
                <button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()" disabled>Previous</button>
                <button class="btn" id="nextBtn" onclick="nextQuestion()">Next</button>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="resultScreen" class="hidden">
            <div class="content">
                <div class="result-container">
                    <div class="result-icon" id="resultIcon">üèÜ</div>
                    <div class="result-title" id="resultTitle">Results</div>
                    <div class="result-score" id="resultScore">0/10</div>
                    <div class="result-message" id="resultMessage"></div>
                    <div id="prizeBadge"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <h2>Submit Quiz?</h2>
            <p>Are you sure you want to submit your quiz? You won't be able to change your answers.</p>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="cancelSubmit()">Cancel</button>
                <button class="btn" onclick="submitQuiz()">Submit</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
        <div class="loading-text">Calculating your score...</div>
    </div>

    <script>
        const quizData = [
            {
                q: "What does BNS stand for?",
                options: ["Bharat Nyaya Sanhita", "Bharat National Security", "Bharat New System", "Bharat Nyaya Suraksha"],
                correct: 0
            },
            {
                q: "Which year did the new criminal laws come into effect?",
                options: ["2023", "2024", "2025", "2022"],
                correct: 1
            },
            {
                q: "What does BNSS stand for?",
                options: ["Bharat Nyaya Security System", "Bharat Nyaya Suraksha Sanhita", "Bharat National Safety Standard", "Bharat New Security Sanhita"],
                correct: 1
            },
            {
                q: "The BNS replaces which colonial-era law?",
                options: ["Criminal Procedure Code", "Indian Penal Code", "Indian Evidence Act", "Police Act"],
                correct: 1
            },
            {
                q: "What does BSA stand for?",
                options: ["Bharat Security Act", "Bharat Sakshya Adhiniyam", "Bharat Safety Act", "Bharat Suraksha Abhiyan"],
                correct: 1
            },
            {
                q: "Under BNS, sedition has been replaced with which provision?",
                options: ["Treason", "Acts endangering sovereignty", "National security threat", "Public disorder"],
                correct: 1
            },
            {
                q: "BNSS replaces which law?",
                options: ["IPC", "CrPC", "Evidence Act", "Civil Procedure Code"],
                correct: 1
            },
            {
                q: "What is the main objective of the new criminal laws?",
                options: ["Increase punishment", "Decolonize and modernize justice", "Reduce cases", "Increase police power"],
                correct: 1
            },
            {
                q: "Under BNSS, what is the timeline for filing charge sheets in most cases?",
                options: ["30 days", "60 days", "90 days", "120 days"],
                correct: 2
            },
            {
                q: "Which act does BSA replace?",
                options: ["IPC", "CrPC", "Indian Evidence Act", "Police Act"],
                correct: 2
            }
        ];

        let currentQuestion = 0;
        let userAnswers = new Array(10).fill(null);
        let timerInterval;
        let timeRemaining = 180;
        let userData = {};

        function startQuiz() {
            const name = document.getElementById('userName').value.trim();
            const occupation = document.getElementById('userOccupation').value;

            if (!name) {
                alert('Please enter your name');
                return;
            }

            if (!occupation) {
                alert('Please select your occupation');
                return;
            }

            userData = { name, occupation };

            document.getElementById('userInfoScreen').classList.add('hidden');
            document.getElementById('quizScreen').classList.remove('hidden');

            renderProgressDots();
            renderQuestion();
            startTimer();
        }

        function renderProgressDots() {
            const container = document.getElementById('progressDots');
            container.innerHTML = '';
            for (let i = 0; i < 10; i++) {
                const dot = document.createElement('div');
                dot.className = 'dot';
                dot.id = `dot${i}`;
                container.appendChild(dot);
            }
            updateProgressDots();
        }

        function updateProgressDots() {
            for (let i = 0; i < 10; i++) {
                const dot = document.getElementById(`dot${i}`);
                dot.classList.remove('active', 'answered');
                if (i === currentQuestion) {
                    dot.classList.add('active');
                } else if (userAnswers[i] !== null) {
                    dot.classList.add('answered');
                }
            }
        }

        function renderQuestion() {
            const question = quizData[currentQuestion];
            document.getElementById('questionText').textContent = `${currentQuestion + 1}. ${question.q}`;
            document.getElementById('questionCounter').textContent = `${currentQuestion + 1}/10`;

            const container = document.getElementById('optionsContainer');
            container.innerHTML = '';

            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                if (userAnswers[currentQuestion] === index) {
                    optionDiv.classList.add('selected');
                }
                optionDiv.onclick = () => selectOption(index);

                optionDiv.innerHTML = `
                    <input type="radio" name="currentQ" value="${index}" id="opt${index}" ${userAnswers[currentQuestion] === index ? 'checked' : ''}>
                    <label class="option-label" for="opt${index}">${option}</label>
                `;

                container.appendChild(optionDiv);
            });

            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            const nextBtn = document.getElementById('nextBtn');
            if (currentQuestion === 9) {
                nextBtn.textContent = 'Submit';
                nextBtn.onclick = () => confirmSubmit();
            } else {
                nextBtn.textContent = 'Next';
                nextBtn.onclick = () => nextQuestion();
            }

            updateProgressDots();
        }

        function selectOption(index) {
            userAnswers[currentQuestion] = index;
            
            document.querySelectorAll('.option').forEach((opt, i) => {
                if (i === index) {
                    opt.classList.add('selected');
                } else {
                    opt.classList.remove('selected');
                }
            });

            updateProgressDots();
        }

        function nextQuestion() {
            if (currentQuestion < 9) {
                currentQuestion++;
                renderQuestion();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
            }
        }

        function startTimer() {
            const timerEl = document.getElementById('timer');
            
            timerInterval = setInterval(() => {
                timeRemaining--;
                
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;
                timerEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeRemaining <= 120 && timeRemaining > 60) {
                    timerEl.className = 'timer warning';
                } else if (timeRemaining <= 60) {
                    timerEl.className = 'timer critical';
                }
                
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    autoSubmit();
                }
            }, 1000);
        }

        function confirmSubmit() {
            const modal = document.getElementById('confirmModal');
            modal.style.display = 'flex';
        }

        function cancelSubmit() {
            const modal = document.getElementById('confirmModal');
            modal.style.display = 'none';
        }

        function autoSubmit() {
            alert("Time's up! Quiz will be submitted.");
            submitQuiz();
        }

        function submitQuiz() {
            clearInterval(timerInterval);
            document.getElementById('confirmModal').style.display = 'none';
            document.getElementById('loadingOverlay').style.display = 'flex';

            setTimeout(() => {
                calculateResults();
            }, 1500);
        }

        function calculateResults() {
            let score = 0;

            quizData.forEach((q, index) => {
                if (userAnswers[index] === q.correct) {
                    score++;
                }
            });

            const timeTaken = 180 - timeRemaining;

            const result = {
                name: userData.name,
                occupation: userData.occupation,
                score: score,
                totalQuestions: 10,
                timeTaken: timeTaken,
                timestamp: new Date().toISOString()
            };

            saveToLocalStorage(result);
            sendToGoogleSheets(result);
            displayResults(score);
        }

        function saveToLocalStorage(result) {
            try {
                const allResults = JSON.parse(localStorage.getItem('quizResults') || '[]');
                allResults.push(result);
                localStorage.setItem('quizResults', JSON.stringify(allResults));
                console.log('‚úÖ Saved to localStorage:', result);
            } catch (e) {
                console.error('‚ùå Error saving to localStorage:', e);
            }
        }

        function sendToGoogleSheets(result) {
            // üî¥ IMPORTANT: REPLACE THIS URL WITH YOUR GOOGLE APPS SCRIPT WEB APP URL
            const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbzSGMqOGnC1aKTUk9omY9GdbuKPTDJrLX9Kv_W3-rc8q4vcLN6_mDTl9sLtVRMbMTbdrQ/exec';
            
            if (GOOGLE_SHEETS_URL.includes('PASTE_YOUR')) {
                console.log('‚ö†Ô∏è Google Sheets URL not configured. Data saved locally only.');
                return;
            }

            console.log('üì§ Sending to Google Sheets...', result);

            fetch(GOOGLE_SHEETS_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(result)
            })
            .then(() => {
                console.log('‚úÖ Data sent to Google Sheets successfully');
            })
            .catch((error) => {
                console.error('‚ùå Error sending to Google Sheets:', error);
            });
        }

        function displayResults(score) {
            document.getElementById('loadingOverlay').style.display = 'none';
            document.getElementById('quizScreen').classList.add('hidden');
            
            const resultScreen = document.getElementById('resultScreen');
            resultScreen.classList.remove('hidden');

            const resultIcon = document.getElementById('resultIcon');
            const resultTitle = document.getElementById('resultTitle');
            const resultScore = document.getElementById('resultScore');
            const resultMessage = document.getElementById('resultMessage');
            const prizeBadge = document.getElementById('prizeBadge');

            resultScore.textContent = `${score}/10`;

            if (score === 10) {
                resultIcon.textContent = 'üéâ';
                resultTitle.textContent = 'Congratulations!';
                resultMessage.textContent = `Excellent performance, ${userData.name}! You scored a perfect 10 out of 10. Please collect your gift from the Prosecution stall.`;
                prizeBadge.innerHTML = '<div class="prize-badge">üéÅ Collect Your Gift!</div>';
            } else {
                resultIcon.textContent = 'üëç';
                resultTitle.textContent = 'Good Try!';
                resultMessage.textContent = `Thank you for participating, ${userData.name}! You scored ${score} out of 10. Keep learning about the new criminal laws!`;
                prizeBadge.innerHTML = '';
            }
        }

        window.onclick = function(event) {
            const modal = document.getElementById('confirmModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html>
